{% extends "base.html" %}

{% block content %}
<div class="max-w-7xl mx-auto space-y-6 pb-24">
    <div class="flex justify-between items-center border-b border-green-500/20 pb-4">
        <h1 class="text-3xl font-black text-white italic tracking-tighter">ALAMOR <span class="text-green-500">ENGINE</span></h1>
        <button onclick="collectAllData()" class="bg-green-600 hover:bg-green-400 text-black font-bold px-8 py-2 rounded-full shadow-lg transition-all">DEPLOY CORE</button>
    </div>

    <div class="glass-card p-6 grid grid-cols-1 md:grid-cols-4 gap-4">
        <div class="col-span-4 section-title">Basic & Traffic Control</div>
        <div class="flex items-center gap-2 cyber-input"><input type="checkbox" id="enabled" checked> <span>Enabled</span></div>
        <input type="text" id="remark" placeholder="Remark" class="cyber-input">
        <select id="protocol" class="cyber-input">
            <option value="vless">VLESS</option>
            <option value="vmess">VMess</option>
            <option value="trojan">Trojan</option>
            <option value="shadowsocks">Shadowsocks</option>
            <option value="hysteria2">Hysteria 2</option>
        </select>
        <input type="text" id="listen" placeholder="Listen IP (0.0.0.0)" class="cyber-input">
        <input type="number" id="port" placeholder="Port" class="cyber-input">
        <input type="number" id="total_flow" placeholder="Total Flow (GB)" class="cyber-input">
        <input type="number" id="duration" placeholder="Duration (Days)" class="cyber-input">
        <select id="traffic_reset" class="cyber-input"><option>No Reset</option><option>Monthly</option></select>
    </div>

    <div class="glass-card p-6 grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="col-span-3 section-title text-blue-400">Security & Auth</div>
        <input type="text" id="uuid" placeholder="UUID / Password" class="cyber-input">
        <input type="text" id="decryption" placeholder="Decryption (none)" class="cyber-input">
        <input type="text" id="encryption" placeholder="Encryption (auto)" class="cyber-input">
    </div>

    <div class="glass-card p-6">
        <div class="section-title text-orange-400">Fallbacks Settings</div>
        <textarea id="fallbacks" class="cyber-input h-24 font-mono text-xs w-full" placeholder='[{"name": "dest", "port": 80, "path": "/proxy"}]'></textarea>
    </div>

    <div class="glass-card p-6">
        <div class="section-title text-purple-400">Transmission & Advanced Sockopt</div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <input type="text" id="tcp_congestion" placeholder="TCP Congestion (bbr)" class="cyber-input">
            <input type="number" id="tcp_keep_alive_interval" placeholder="Keep Alive Interval" class="cyber-input">
            <input type="number" id="tcp_keep_alive_idle" placeholder="Keep Alive Idle" class="cyber-input">
            <input type="number" id="tcp_max_seg" placeholder="TCP Max Seg" class="cyber-input">
            <input type="number" id="tcp_user_timeout" placeholder="TCP User Timeout" class="cyber-input">
            <input type="number" id="tcp_window_clamp" placeholder="TCP Window Clamp" class="cyber-input">
            <input type="text" id="interface_name" placeholder="Interface Name" class="cyber-input">
            <input type="number" id="route_mark" placeholder="Route Mark" class="cyber-input">
        </div>
        
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 bg-black/20 p-4 rounded-xl">
            <label class="flex items-center gap-2"><input type="checkbox" id="tproxy"> TProxy</label>
            <label class="flex items-center gap-2"><input type="checkbox" id="tcp_fast_open"> TCP Fast Open</label>
            <label class="flex items-center gap-2"><input type="checkbox" id="multipath_tcp"> Multipath TCP</label>
            <label class="flex items-center gap-2"><input type="checkbox" id="penetrate"> Penetrate</label>
            <label class="flex items-center gap-2"><input type="checkbox" id="v6_only"> V6 Only</label>
            <label class="flex items-center gap-2"><input type="checkbox" id="proxy_protocol"> Proxy Protocol</label>
        </div>
    </div>

    <div class="glass-card p-6 grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="col-span-2 section-title text-pink-400">HTTP Obfuscation (Request / Response)</div>
        <textarea id="req_header" class="cyber-input h-20 text-xs" placeholder="Request Headers..."></textarea>
        <textarea id="res_header" class="cyber-input h-20 text-xs" placeholder="Response Headers..."></textarea>
    </div>
</div>

<script>
function collectAllData() {
    const data = {
        base: {
            enabled: document.getElementById('enabled').checked,
            remark: document.getElementById('remark').value,
            protocol: document.getElementById('protocol').value,
            port: document.getElementById('port').value,
            listen: document.getElementById('listen').value,
            total: document.getElementById('total_flow').value
        },
        sockopt: {
            congestion: document.getElementById('tcp_congestion').value,
            tproxy: document.getElementById('tproxy').checked,
            fast_open: document.getElementById('tcp_fast_open').checked
            // بقیه فیلدها هم به همین صورت اضافه میشن
        }
    };
    console.log("ALAMOR PAYLOAD:", data);
    alert("Data Captured! Check Console.");
}
</script>
{% endblock %}